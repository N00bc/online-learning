# 项目笔记

## Day3笔记：

JSR303校验：表单参数校验。

步骤：

1. 引入JSR303校验坐标

    ```xml
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-validation</artifactId>
    </dependency>
    ```

2. 给DTO的属性上标注相应的校验注解常见注解如下：

    |           限制           |                             说明                             |
    | :----------------------: | :----------------------------------------------------------: |
    |         @NotNull         |                       限制必须不为Null                       |
    |       @AssertTrue        |                        限制必须为true                        |
    | @Max/@Min/@Size(max,min) |                            限制值                            |
    |        @NotEmpty         | 验证注解的元素值部位null且不为空（字符串长度不为0，集合大小不为0） |
    |        @NotBlank         | 验证注解的元素值不为空（不为null、去除首位空格后长度为0），不同于@NotEmpty，@NotBlank只应用于字符串且在比较时会去除字符串空格 |

3. 在前端控制器中加入 `@Validated`注解用于自动校验

4. 自定义注解如果报出异常需要在全局异常处理器中处理该异常逻辑如下

    ```java
    @ExceptionHandler(MethodArgumentNotValidException.class)
    @ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)// 返回状态码注解
    public RestErrorResponse doMethodArgumentNotValidException(MethodArgumentNotValidException exception) {
        BindingResult bindingResult = exception.getBindingResult();
        // 获取错误集合
        List<FieldError> fieldErrors = bindingResult.getFieldErrors();
        // 将错误信息收集
        StringBuffer errorMsg = new StringBuffer();
        fieldErrors.forEach(error -> errorMsg.append(error.getDefaultMessage()).append(","));
        log.error("捕获异常信息:{}", errorMsg);
        exception.printStackTrace();
        // 若发生系统内部异常则返回友好提示
        return new RestErrorResponse(errorMsg.toString());
    }
    ```

    

